<h1 id="page-router-é¡µé¢è·¯ç”±"><a class="header-anchor" href="#page-router-é¡µé¢è·¯ç”±">#</a>Page Router (é¡µé¢è·¯ç”±)</h1><p><strong>Lupine.web</strong> ä¸­çš„ <code>PageRouter</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å®¢æˆ·ç«¯è·¯ç”±ç³»ç»Ÿï¼Œå…¶é€»è¾‘è®¾è®¡ä¸åç«¯çš„ <code>ApiRouter</code> (ä½äº <code>lupine.api</code> ä¸­) ä¿æŒ <strong>åŒæ„</strong>ã€‚å®ƒæ”¯æŒåµŒå¥—è·¯ç”±ã€ä¸­é—´ä»¶è¿‡æ»¤å™¨ã€åŠ¨æ€å‚æ•°å’Œå¸ƒå±€æ¡†æ¶ (Layout Frames)ã€‚</p>
<h2 id="1-ä¸å…¶ä»–æ¡†æ¶çš„å¯¹æ¯”"><a class="header-anchor" href="#1-ä¸å…¶ä»–æ¡†æ¶çš„å¯¹æ¯”">#</a>1. âš–ï¸ ä¸å…¶ä»–æ¡†æ¶çš„å¯¹æ¯”</h2><p>ä¸é€šç”¨çš„è·¯ç”±å™¨ï¼ˆå¦‚ <code>react-router</code> æˆ– <code>vue-router</code>ï¼‰ç›¸æ¯”ï¼š</p>
<ul>
<li><strong>é€»è¾‘ä¸€è‡´æ€§</strong>ï¼šå®ƒä¸åç«¯çš„ <code>ApiRouter</code> å…±äº«å®Œå…¨ç›¸åŒçš„è·¯ç”±å“²å­¦ã€‚å¦‚æœä½ çŸ¥é“å¦‚ä½•ç¼–å†™ Lupine åç«¯ APIï¼Œä½ å°±çŸ¥é“å¦‚ä½•ç¼–å†™å‰ç«¯è·¯ç”±ã€‚</li>
<li><strong>çœŸæ­£çš„åµŒå¥—</strong>ï¼šä½ å¯ä»¥å°†ä¸€ä¸ªå®Œæ•´çš„ <code>PageRouter</code> å®ä¾‹æŒ‚è½½åˆ°å¦ä¸€ä¸ªè·¯ç”±å™¨çš„ç‰¹å®šè·¯å¾„ä¸Šï¼ˆä¾‹å¦‚ï¼š<code>router.use(&#39;/user&#39;, userRouter)</code>ï¼‰ï¼Œä»è€Œå®ç°çœŸæ­£çš„æ¨¡å—åŒ–ã€‚</li>
<li><strong>å†…ç½®å¸ƒå±€</strong>ï¼š<code>setFramePage</code> å°†å¸ƒå±€è§†ä¸ºä¸€ç­‰å…¬æ°‘ï¼Œèƒ½å¤Ÿå°†å†…å®¹æ³¨å…¥åˆ°ç‰¹å®šçš„å ä½ç¬¦ç±»ä¸­ã€‚</li>
</ul>
<h2 id="2-åŸºæœ¬ç”¨æ³•"><a class="header-anchor" href="#2-åŸºæœ¬ç”¨æ³•">#</a>2. ğŸ£ åŸºæœ¬ç”¨æ³•</h2><p>æœ€ç®€å•çš„å¼€å§‹æ–¹æ³•æ˜¯å°†è·¯å¾„æ˜ å°„åˆ°é¡µé¢ç»„ä»¶ã€‚</p>
<pre><code class="language-tsx">import { PageRouter, bindRouter } from &#39;lupine.web&#39;;

// 1. åˆ›å»º Router
const pageRouter = new PageRouter();

// 2. å®šä¹‰è·¯ç”±
pageRouter.use(&#39;/home&#39;, HomePage);
pageRouter.use(&#39;/about&#39;, AboutPage);
// 404 é€šé…ç¬¦
pageRouter.use(&#39;*&#39;, NotFoundPage);

// 3. ç»‘å®šåˆ°ç³»ç»Ÿ
bindRouter(pageRouter);
</code></pre>
<h2 id="3-åŠ¨æ€å‚æ•°"><a class="header-anchor" href="#3-åŠ¨æ€å‚æ•°">#</a>3. ğŸ”§ åŠ¨æ€å‚æ•°</h2><p>Lupine ç›´æ¥åœ¨ URL å­—ç¬¦ä¸²ä¸­æ”¯æŒå¿…é€‰å’Œå¯é€‰å‚æ•°ã€‚æ‰€æœ‰æ•è·çš„å‚æ•°éƒ½å¯ä»¥åœ¨ <code>props.urlParameters</code> ä¸­è·å–ã€‚</p>
<h3 id="è¯­æ³•"><a class="header-anchor" href="#è¯­æ³•">#</a>è¯­æ³•</h3><ul>
<li><code>/:id</code> : å¿…é€‰å‚æ•°ã€‚</li>
<li><code>/?id</code> : å¯é€‰å‚æ•°ã€‚ï¼ˆæ‰€æœ‰åç»­å‚æ•°ä¹Ÿå¿…é¡»æ˜¯å¯é€‰çš„ï¼‰ã€‚</li>
<li><code>?key=value</code> : ä¹Ÿæ”¯æŒæ ‡å‡†çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆå•ç‹¬è§£æï¼‰ã€‚</li>
</ul>
<h3 id="ç¤ºä¾‹"><a class="header-anchor" href="#ç¤ºä¾‹">#</a>ç¤ºä¾‹</h3><pre><code class="language-tsx">// å®šä¹‰:
pageRouter.use(&#39;/share/:type/:id/&#39;, ShareContentPage);

// åœ¨ ShareContentPage ä¸­ä½¿ç”¨:
export const ShareContentPage = (props: PageProps) =&gt; {
  // è·å–å‚æ•°
  const type = props.urlParameters[&#39;type&#39;];
  const id = props.urlParameters[&#39;id&#39;];

  return (
    &lt;div&gt;
      æ­£åœ¨æŸ¥çœ‹ {type}ï¼ŒIDä¸º: {id}
    &lt;/div&gt;
  );
};
</code></pre>
<h2 id="4-é«˜çº§ç‰¹æ€§"><a class="header-anchor" href="#4-é«˜çº§ç‰¹æ€§">#</a>4. ğŸš€ é«˜çº§ç‰¹æ€§</h2><h3 id="4-1-åµŒå¥—è·¯ç”±-æ¨¡å—åŒ–"><a class="header-anchor" href="#4-1-åµŒå¥—è·¯ç”±-æ¨¡å—åŒ–">#</a>4.1 ğŸ åµŒå¥—è·¯ç”± (æ¨¡å—åŒ–)</h3><p>ä½ å¯ä»¥å°†åº”ç”¨ç¨‹åºæ‹†åˆ†ä¸ºå­æ¨¡å—ã€‚</p>
<pre><code class="language-tsx">// 1. ä¸ºç”¨æˆ·ä¸ªäººèµ„æ–™åŒºåŸŸåˆ›å»ºä¸€ä¸ªå­è·¯ç”±å™¨
const userPageRouter = new PageRouter();
userPageRouter.use(&#39;/profile&#39;, UserProfilePage);
userPageRouter.use(&#39;/settings&#39;, UserSettingsPage);

// 2. å°†å…¶æŒ‚è½½åˆ°ä¸»è·¯ç”±å™¨ä¸‹çš„ &#39;/user&#39; è·¯å¾„
const mainRouter = new PageRouter();
mainRouter.use(&#39;/user&#39;, userPageRouter);

// ç°åœ¨çš„ URL æ˜¯: /user/profile, /user/settings
</code></pre>
<h3 id="4-2-ä¸­é—´ä»¶è¿‡æ»¤å™¨-é‰´æƒ"><a class="header-anchor" href="#4-2-ä¸­é—´ä»¶è¿‡æ»¤å™¨-é‰´æƒ">#</a>4.2 ğŸ›¡ï¸ ä¸­é—´ä»¶è¿‡æ»¤å™¨ (é‰´æƒ)</h3><p>ä½ å¯ä»¥é™„åŠ ä¸€ä¸ªâ€œè¿‡æ»¤å™¨ (Filter)â€å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šåœ¨ <em>ä»»ä½•</em> è·¯ç”±è§£æä¹‹å‰è¿è¡Œã€‚å¦‚æœè¿‡æ»¤å™¨å¤„ç†äº†è¯·æ±‚ï¼ˆä¾‹å¦‚ï¼Œé‡å®šå‘åˆ°ç™»å½•ï¼‰æˆ–è¿”å›äº†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè·¯ç”±å°†åœæ­¢ã€‚å¦‚æœå®ƒè¿”å› <code>null</code>ï¼Œè·¯ç”±å°†ç»§ç»­ã€‚</p>
<pre><code class="language-tsx">// å…¨å±€è¿‡æ»¤å™¨
pageRouter.setFilter(checkAgreement);

// ç‰¹å®šè·¯ç”±è¿‡æ»¤å™¨ (ä¸­é—´ä»¶æ¨¡å¼)
const checkAuth = async (props) =&gt; {
  if (!isLoggedIn()) {
    // æ¸²æŸ“ç™»å½•é¡µé¢æˆ–é‡å®šå‘
    return &lt;LoginPage /&gt;;
  }
  return null; // ç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åº
};

// ç”¨æ³•: checkAuth å…ˆè¿è¡Œï¼Œç„¶åæ‰æ˜¯ UserMinePage
userPageRouter.use(&#39;/mine&#39;, checkAuth, UserMinePage);
</code></pre>
<h3 id="4-3-æ¡†æ¶é¡µé¢-å¸ƒå±€"><a class="header-anchor" href="#4-3-æ¡†æ¶é¡µé¢-å¸ƒå±€">#</a>4.3 ğŸ–¼ï¸ æ¡†æ¶é¡µé¢ (å¸ƒå±€)</h3><p>ä¸ React Router åµŒå¥— <code>&lt;Outlet /&gt;</code> ä¸åŒï¼ŒLupine ä½¿ç”¨ <code>setFramePage</code> æ–¹æ³•ä¸ºè¯¥ Router å†…çš„æ‰€æœ‰è·¯ç”±å®šä¹‰ä¸€ä¸ªâ€œåŒ…è£…å™¨â€æˆ–â€œå¸ƒå±€â€ã€‚</p>
<pre><code class="language-tsx">// 1. å®šä¹‰æ¡†æ¶
const TopFrame = (placeholderClass, childNode) =&gt; {
  return (
    &lt;div class=&#39;app-container&#39;&gt;
      &lt;Header /&gt;
      &lt;Sidebar /&gt;
      {/* å†…å®¹æ³¨å…¥ç‚¹ */}
      &lt;div class={placeholderClass}&gt;{childNode}&lt;/div&gt;
    &lt;/div&gt;
  );
};

// 2. åº”ç”¨åˆ° Router
const pageRouter = new PageRouter();
pageRouter.setFramePage({
  component: TopFrame,
  placeholderClassname: &#39;app-content-area&#39;, // åŒ¹é…ä¸Šé¢çš„ class
});

pageRouter.use(&#39;/dashboard&#39;, DashboardPage);
// ç»“æœ: DashboardPage è¢«æ¸²æŸ“åœ¨ TopFrame çš„ &#39;app-content-area&#39; div å†…éƒ¨ã€‚
</code></pre>
<h3 id="4-4-å­ç›®å½•éƒ¨ç½²"><a class="header-anchor" href="#4-4-å­ç›®å½•éƒ¨ç½²">#</a>4.4 ğŸ“‚ å­ç›®å½•éƒ¨ç½²</h3><p>å¦‚æœä½ çš„åº”ç”¨éƒ¨ç½²åœ¨ <code>example.com/my-app/</code>ï¼Œä½ éœ€è¦å‘Šè¯‰è·¯ç”±å™¨å¿½ç•¥ <code>/my-app</code> å‰ç¼€ã€‚</p>
<pre><code class="language-typescript">// å¦‚æœç‰©ç†è·¯å¾„å­˜åœ¨ï¼Œè·¯ç”±å™¨éœ€è¦çŸ¥é“è¦å¿½ç•¥å®ƒ
pageRouter.setSubDir(&#39;/my-app&#39;);
</code></pre>
